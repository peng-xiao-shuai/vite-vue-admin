import{s as L,aa as v,ab as U,ac as I,ad as K,q as V,r as k,d as Q,ak as W,S as H,A as D,_ as A,o as b,x as S,w as r,g as o,f as T,J as M,K as O,k as i,j as E,C as J,p as N,b7 as G,ah as R,ai as j,bc as X,bd as Y,l as q,ba as Z,be as x,bf as ee,e as B,P as te,E as ae}from"./index-eb619e6a.js";/* empty css             */import{E as P,a as z}from"./form-item-f9557fea.js";const $=e=>L({url:"modules/table",params:e}),le=e=>L({url:"modules/table/remove",method:"delete",data:{ids:e}}),oe=()=>{const e=[{label:"编号",minWidth:"60",sortable:!0,props:[{prop:"id"}]},{label:"书名",props:[{type:"href",prop:"href",data:{prop:"name",style:{fontWeight:"bold"}}},{text:"热度：",type:"iconfont",prop:"iconfont",data:v({style:{color:"red"}})}]},{label:"封面",width:"120",props:[{type:"image",prop:"image",data:v({style:{width:"40px",height:"60px",borderRadius:"5px"},property:{}})}]},{label:"类型",width:"100",props:[{prop:"types",filters:[{key:0,value:"玄幻"},{key:1,value:"都市"},{key:2,value:"真实"}]}]},{label:"内容",width:"150",props:[{prop:"text",data:{develop:!0,line:3}}]},{label:"评分",width:"150",props:[{prop:"rate",type:"rate",data:v({property:{max:5,allowHalf:!0}})}]},{label:"推荐",width:"100",props:[{prop:"recommend",type:"switch",data:v({property:{inactiveValue:0,activeValue:1}})}]},{label:"价格",width:"120",props:[{text:"原价：",prop:"oldPrice"},{prop:"price",type:"input",data:v({property:{placeholder:"请输入现价"}})}]},{label:"更新时间（远程搜索）",sortable:"custom",props:[{prop:"date"}]},{label:"操作",minWidth:"180px",fixed:"right",props:[{type:"btn",prop:"",data:v([{text:"修改",params:"update",property:{type:"primary",icon:U(I)}},{text:"删除",params:"remove",property:{type:"danger",icon:U(K)}}])}]}],t=V({listQuery:{pageNum:1,pageSize:10,types:"",name:""},total:0,list:[]}),s=k([{value:0,label:"玄幻"},{value:1,label:"都市"},{value:2,label:"真实"}]),m=V({value:0,operates:[{label:"推荐",value:0},{label:"取消推荐",value:1},{label:"删除",value:2}]}),g=k(!1),c=V({});return{selectData:k([]),header:e,powerfulTableData:t,selectMenuList:s,operateData:m,isDialog:g,currentForm:c}},re={name:"",image:[],types:"",text:"",rate:0,recommend:"",oldPrice:"",price:"",id:""},se=Q({props:{dialog:{type:Boolean,default:!1},currentForm:{type:Object,default:()=>{}},selectMenuList:{type:Array,default:()=>[]}},emits:["update:currentForm","update:dialog","refresh"],setup(e,t){const s=V({...re}),m=k(null);return W(e.currentForm,n=>{Object.assign(s,n)},{immediate:!0}),{uploadForm:m,formData:s,close:()=>{t.emit("update:dialog",!1),t.emit("update:currentForm",{})},resetForm:()=>{m.value.resetFields(),t.emit("update:currentForm",{})},onSubmit:()=>{m.value.validate(n=>{if(n)H.confirm("是否提交数据","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{e.currentForm.id?D({message:"修改成功",type:"success",duration:1e3}):setTimeout(()=>{D({message:"提交成功",type:"success",duration:1e3})},200),setTimeout(()=>{t.emit("refresh",{...s}),t.emit("update:dialog",!1)},200)});else return D({message:"验证失败",type:"error",duration:1e3}),!1})},rules:{title:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:2,max:140,message:"长度在 2 到 140 个字符",trigger:"blur"}],name:[{required:!0,message:"请输入前端名称",trigger:"blur"},{min:2,max:140,message:"长度在 2 到 140 个字符",trigger:"blur"}],icon:[{required:!0,message:"请输入前端图标",trigger:"blur"},{min:2,max:140,message:"长度在 2 到 140 个字符",trigger:"blur"}]}}}});const ne={class:"a"},ue={class:"grid grid-c-2"};function ie(e,t,s,m,g,c){const d=N,n=P,f=G,h=R,y=j,F=X,_=Y,C=q,w=z,a=Z;return b(),S(a,{title:e.currentForm.id?"修改":"添加","model-value":e.dialog,direction:"rtl",ref:"drawer",onClose:e.close},{default:r(()=>[o(w,{model:e.formData,rules:e.rules,ref:"uploadForm","label-position":"top",style:{padding:"0 20px"},class:"Dform"},{default:r(()=>[o(n,{label:"书名",prop:"name"},{default:r(()=>[o(d,{modelValue:e.formData.name,"onUpdate:modelValue":t[0]||(t[0]=l=>e.formData.name=l)},null,8,["modelValue"])]),_:1}),o(n,{label:"封面",prop:"image"},{default:r(()=>[o(f,{modelValue:e.formData.image,"onUpdate:modelValue":t[1]||(t[1]=l=>e.formData.image=l),limit:1,tipLabel:"当前仅为示例，请改成可上传地址"},null,8,["modelValue"])]),_:1}),o(n,{label:"类型",prop:"types"},{default:r(()=>[o(y,{modelValue:e.formData.types,"onUpdate:modelValue":t[2]||(t[2]=l=>e.formData.types=l),placeholder:"请选择",style:{width:"100%"}},{default:r(()=>[(b(!0),T(M,null,O(e.selectMenuList,l=>(b(),S(h,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(n,{label:"内容",prop:"text"},{default:r(()=>[o(d,{type:"textarea",modelValue:e.formData.text,"onUpdate:modelValue":t[3]||(t[3]=l=>e.formData.text=l),rows:"7"},null,8,["modelValue"])]),_:1}),o(n,{label:"评分",prop:"rate"},{default:r(()=>[i("div",ne,[o(F,{modelValue:e.formData.rate,"onUpdate:modelValue":t[4]||(t[4]=l=>e.formData.rate=l),colors:[e.themeColor,e.themeColor,e.themeColor]},null,8,["modelValue","colors"])])]),_:1}),o(n,{label:"推荐",prop:"recommend"},{default:r(()=>[o(_,{modelValue:e.formData.recommend,"onUpdate:modelValue":t[5]||(t[5]=l=>e.formData.recommend=l),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),i("div",ue,[o(n,{label:"原价",prop:"oldPrice"},{default:r(()=>[o(d,{modelValue:e.formData.oldPrice,"onUpdate:modelValue":t[6]||(t[6]=l=>e.formData.oldPrice=l)},null,8,["modelValue"])]),_:1}),o(n,{label:"现价",prop:"price"},{default:r(()=>[o(d,{modelValue:e.formData.price,"onUpdate:modelValue":t[7]||(t[7]=l=>e.formData.price=l)},null,8,["modelValue"])]),_:1})]),o(n,null,{default:r(()=>[o(C,{type:"primary",onClick:e.onSubmit},{default:r(()=>t[9]||(t[9]=[E("提交")])),_:1,__:[9]},8,["onClick"]),e.formData.id?J("",!0):(b(),S(C,{key:0,onClick:t[8]||(t[8]=l=>e.resetForm())},{default:r(()=>t[10]||(t[10]=[E("重置")])),_:1,__:[10]}))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","model-value","onClose"])}const de=A(se,[["render",ie],["__scopeId","data-v-7c353b89"]]),pe=Q({name:"ModulesTable",components:{Update:de,Search:x,Tickets:ee},setup(){const{selectData:e,header:t,powerfulTableData:s,selectMenuList:m,operateData:g,isDialog:c,currentForm:d}=oe(),n=a=>{e.value=(a==null?void 0:a.select)||[],a!=null&&a.params&&(Object.assign(s.listQuery,a.params),console.log(s.listQuery,a.params)),$(s.listQuery).then(l=>{s.list=l.data.list,s.total=l.data.total})},f=a=>{s.listQuery[a.prop]=a.order,n()},h=a=>{switch(a.componentName){case"switch":console.log(a),s.list[a.index||0]=a.row,D.success("修改成功");break}},y=({ids:a,item:l})=>{switch(l.value){case 0:case 1:s.list.forEach((p,u)=>{a.indexOf(p.id)!==-1&&(l.value===0?p.recommend=1:p.recommend=0)}),D.success("修改成功");break;case 2:_(a);break}},F=({params:a,row:l})=>{switch(a){case"update":c.value=!0;const p={...l};p.image=[{url:l.image,name:"book.jpg"}],Object.assign(d,p);break;case"delete":_([l.id]);break}},_=a=>{le(a).then(()=>{D.success("删除成功"),n()})};return{operateData:g,isDialog:c,currentForm:d,selectData:e,selectMenuList:m,powerfulTableData:s,header:t,tableFun:$,handleResetSearch:()=>{Object.keys(s.listQuery).forEach((a,l)=>{["pageNum","pageSize"].indexOf(a)==-1&&(s.listQuery[a]="")})},handleBtnClick:F,refresh:a=>{if(a.id){let l=s.list.map(p=>p.id).indexOf(a.id);a.image=a.image[0].url,s.list[l]=a}else s.list.push({...a,image:a.image[0].url,id:s.list[s.list.length-1].id+1,iconfont:"vitehome-liulanliang",href:"https://gitee.com/abc1612565136/vite-admin"})},getList:n,handleComponentChange:h,handleBatchChange:y,handleSortCustom:f}}});const me={class:"app-container"},ce={class:"operate-container"},fe={class:"_flex _flex-align-center"},be={style:{"margin-top":"15px"}},ge={class:"screenForm"},ye={class:"operate-container"},_e={class:"_flex _flex-align-center"};function ve(e,t,s,m,g,c){const d=B("Search"),n=te,f=q,h=N,y=P,F=R,_=j,C=z,w=ae,a=B("Tickets"),l=B("powerful-table"),p=B("Update");return b(),T("div",me,[o(w,{class:"filter-container",style:{marginBottom:"20px"},shadow:e.defaultData.cardShadow},{default:r(()=>[i("div",ce,[i("div",fe,[o(n,null,{default:r(()=>[o(d)]),_:1}),t[7]||(t[7]=i("span",null,"筛选搜索",-1))]),i("div",null,[o(f,{style:{float:"right"},type:"primary",onClick:t[0]||(t[0]=u=>e.getList())},{default:r(()=>t[8]||(t[8]=[E(" 查询搜索 ")])),_:1,__:[8]}),o(f,{style:{float:"right","margin-right":"15px"},onClick:t[1]||(t[1]=u=>e.handleResetSearch())},{default:r(()=>t[9]||(t[9]=[E(" 重置 ")])),_:1,__:[9]})])]),i("div",be,[o(C,{inline:!0,model:e.powerfulTableData.listQuery},{default:r(()=>[i("div",ge,[o(y,{label:"书名："},{default:r(()=>[o(h,{modelValue:e.powerfulTableData.listQuery.name,"onUpdate:modelValue":t[2]||(t[2]=u=>e.powerfulTableData.listQuery.name=u),placeholder:"请输入书名",style:{width:"80%"},clearable:""},null,8,["modelValue"])]),_:1}),o(y,{label:"书类型：",prop:"types"},{default:r(()=>[o(_,{modelValue:e.powerfulTableData.listQuery.types,"onUpdate:modelValue":t[3]||(t[3]=u=>e.powerfulTableData.listQuery.types=u),placeholder:"请选择"},{default:r(()=>[(b(!0),T(M,null,O(e.selectMenuList,u=>(b(),S(F,{key:u.value,label:u.label,value:u.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),_:1},8,["model"])])]),_:1},8,["shadow"]),o(w,{shadow:e.defaultData.cardShadow},{default:r(()=>[i("div",ye,[i("div",_e,[o(n,{style:{"font-size":"18px"}},{default:r(()=>[o(a)]),_:1}),t[10]||(t[10]=i("div",null,"数据列表",-1))]),i("div",null,[o(f,{type:"primary",class:"btn-add",onClick:t[4]||(t[4]=()=>e.isDialog=!0)},{default:r(()=>t[11]||(t[11]=[E(" 添加 ")])),_:1,__:[11]})])]),o(l,{ref:"Table","list-request":{listApi:e.tableFun,pageNoKey:"pageNum",listsKey:"list",responseKey:"data.data",listQuery:e.powerfulTableData.listQuery},header:e.header,isSelect:!0,tableName:"Table",operateData:e.operateData,selectData:e.selectData,"pagination-property":{total:e.powerfulTableData.total},onSizeChange:e.getList,onSortCustom:e.handleSortCustom,onComponentEvent:e.handleComponentChange,onBatchOperate:e.handleBatchChange,onBtnClick:e.handleBtnClick},null,8,["list-request","header","operateData","selectData","pagination-property","onSizeChange","onSortCustom","onComponentEvent","onBatchOperate","onBtnClick"])]),_:1},8,["shadow"]),o(p,{dialog:e.isDialog,"onUpdate:dialog":t[5]||(t[5]=u=>e.isDialog=u),currentForm:e.currentForm,"onUpdate:currentForm":t[6]||(t[6]=u=>e.currentForm=u),selectMenuList:e.selectMenuList,onRefresh:e.refresh},null,8,["dialog","currentForm","selectMenuList","onRefresh"])])}const Ce=A(pe,[["render",ve],["__scopeId","data-v-f2cbdc82"]]);export{Ce as default};
