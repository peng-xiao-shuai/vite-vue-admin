import{d as O,r as m,q as W,Q as X,R as Y,e as D,o as w,f as h,k as t,g as o,w as a,J as Z,K as ee,n as r,B as N,j as y,v as le,A as C,S as oe,P as te,l as ae,T as ne,p as se,_ as ie}from"./index-eb619e6a.js";import{E as re}from"./dialog-fc59e166.js";/* empty css             */import{E as de,a as ue}from"./form-item-f9557fea.js";import{a as ce}from"./useMap-6ee88f00.js";import"./index-9791d979.js";const me={class:"electronic"},fe={class:"navicon _flex _flex-align-center"},pe=["onClick"],_e={style:{color:"var(--el-color-info-light-3)"}},ve={class:"list-item-operate"},ge={class:"form-element"},xe={class:"btn _flex _flex-justify-between"},ye={class:"search"},Ce={class:"dialog-footer"},be=O({__name:"ali-map-fence",setup(ke){const b=m(""),k=m(!0),u=m([]),p=m(""),f=m(!1),_=m(!1),M=W({fenceName:[{required:!0,message:"请输入电子围栏名称",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}],fenceCode:[{required:!0,message:"请输入电子围栏编号",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}]});X(()=>{E()});const{currentData:n,isDraw:T,isInit:F,get:S,unmounted:$,initMap:I,renderData:L,removePolygon:U,viewPolygon:j,editPolygon:z,createDraw:q,findSearch:A,pushPolygon:G}=ce(u,()=>{C.error("111111")},i=>{C[i.status](i.msg)}),R=()=>{if(!T.value&&!n.id){C.warning("请先完成电子围栏绘制！");return}f.value=!0},J=()=>{var i,e;n.fencePath=(e=(i=S("polyEditor"))==null?void 0:i.getTarget())==null?void 0:e._opts.path,_.value=!0,setTimeout(()=>{f.value=!1,_.value=!1;const c=Number(new Date);G(n.id?n.id:c);const{fenceCode:v,fenceName:g,fencePath:s}=n;u.value.some(d=>d.id===n.id)?u.value.forEach(d=>{d.id===n.id&&(d.fenceCode=v,d.fenceName=g,d.fencePath=s)}):u.value.push({fenceCode:v,fenceName:g,fencePath:s,id:c}),C.success("保存成功！")},1e3)},K=(i,e)=>{oe.confirm('是否确认删除名称为"'+i.fenceName+'"的电子围栏?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{U(e),u.value.splice(e,1)})},E=i=>{Y(i).then(e=>{e.data.data.length&&$(),u.value=e.data.data.map(c=>({...c,fencePath:c.fencePath})),F.value?L():I().then(()=>{console.log("初始化")})})};return(i,e)=>{const c=D("Back"),v=D("Guide"),g=te,s=ae,d=ne,x=se,B=de,Q=ue,H=re;return w(),h("div",me,[e[13]||(e[13]=t("div",{id:"map"},null,-1)),t("div",{class:le(["panel _flex _flex-justify-between",k.value?"":"pack-up"])},[t("div",fe,[t("i",{class:"el-icon",style:{"margin-right":"10px"},onClick:e[0]||(e[0]=l=>k.value=!k.value)},[o(c)]),e[9]||(e[9]=t("span",null,"电子围栏列表",-1))]),o(d,{class:"list-box"},{default:a(()=>[(w(!0),h(Z,null,ee(u.value,(l,P)=>(w(),h("div",{class:"list-item _flex _flex-align-center _flex-justify-between pointer",key:P},[t("div",{onClick:V=>r(j)(l),class:"list-item-content _flex _flex-align-center"},[o(g,null,{default:a(()=>[o(v)]),_:1}),t("span",null,N(l.fenceName?l.fenceName:"未命名"),1),t("span",_e,"（"+N(l.fenceCode)+"）",1)],8,pe),t("div",ve,[o(s,{onClick:V=>r(z)(V,l),type:"primary",icon:"edit",size:"small"},null,8,["onClick"]),o(s,{onClick:V=>K(l,P),type:"danger",icon:"delete",size:"small"},null,8,["onClick"])])]))),128))]),_:1}),t("div",ge,[o(x,{placeholder:"查询电子围栏名称",modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=l=>b.value=l),maxlength:"10","show-word-limit":""},{append:a(()=>[o(s,{icon:"search",onClick:e[1]||(e[1]=l=>E(b.value))})]),_:1},8,["modelValue"]),t("div",xe,[o(s,{type:"default",onClick:r(q)},{default:a(()=>e[10]||(e[10]=[y("绘制新电子围栏")])),_:1,__:[10]},8,["onClick"]),o(s,{type:"primary",onClick:R},{default:a(()=>e[11]||(e[11]=[y("保存")])),_:1,__:[11]})])])],2),t("div",ye,[o(x,{type:"text",placeholder:"查询地址",modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=l=>p.value=l)},{append:a(()=>[o(s,{icon:"search",onClick:e[3]||(e[3]=l=>p.value&&r(A)(p.value))})]),_:1},8,["modelValue"])]),o(H,{class:"save-dialog",modelValue:f.value,"onUpdate:modelValue":e[8]||(e[8]=l=>f.value=l),width:"300px","show-close":!1},{footer:a(()=>[t("span",Ce,[o(s,{onClick:e[7]||(e[7]=l=>f.value=!1),size:"small"},{default:a(()=>e[12]||(e[12]=[y("取 消")])),_:1,__:[12]}),o(s,{loading:_.value,type:"primary",onClick:J},{default:a(()=>[y(N(_.value?"保存中":"确 定"),1)]),_:1},8,["loading"])])]),default:a(()=>[o(Q,{class:"form",model:r(n),rules:M,"label-position":"top"},{default:a(()=>[o(B,{prop:"fenceCode",label:"电子围栏编号",style:{width:"100%"}},{default:a(()=>[o(x,{modelValue:r(n).fenceCode,"onUpdate:modelValue":e[5]||(e[5]=l=>r(n).fenceCode=l),placeholder:"请输入电子围栏编号"},null,8,["modelValue"])]),_:1}),o(B,{prop:"fenceName",label:"电子围栏名称",style:{width:"100%"}},{default:a(()=>[o(x,{modelValue:r(n).fenceName,"onUpdate:modelValue":e[6]||(e[6]=l=>r(n).fenceName=l),placeholder:"请输入电子围栏名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});const Pe=ie(be,[["__scopeId","data-v-d485ecbb"]]);export{Pe as default};
