import{O as q,d as T,q as L,Q as v,bO as z,_ as G,o as I,f as D,k as m,j as o,g as u,w as t,J as N,C as J,ah as h,ai as U,c4 as Z,p as $,l as H,D as k,ag as Q,c5 as R,c6 as j,r as w,e as S,c7 as W,i as K,E as Y}from"./index-eb619e6a.js";/* empty css             */import{b as M,a as O}from"./radio-group-61aeea81.js";import{E as X,a as P}from"./form-item-f9557fea.js";const c=[{date:"2016-05-03",name:"汤姆",address:"No. 189, Grove St, Los Angeles"},{date:"2016-05-02",name:"汤姆",address:"No. 189, Grove St, Los Angeles"},{date:"2016-05-04",name:"汤姆",address:"No. 189, Grove St, Los Angeles"},{date:"2016-05-01",name:"汤姆",address:"No. 189, Grove St, Los Angeles"},{date:"2016-05-08",name:"汤姆",address:"No. 189, Grove St, Los Angeles"},{date:"2016-05-06",name:"汤姆",address:"No. 189, Grove St, Los Angeles"},{date:"2016-05-07",name:"汤姆",address:"No. 189, Grove St, Los Angeles"}],ee=[{date:"2016-05-03",name:"Tom",state:"California",city:"Los Angeles",address:"No. 189, Grove St, Los Angeles",money:"999",zip:"CA 90036"},{date:"2016-05-02",name:"Tom",state:"California",city:"Los Angeles",address:"No. 189, Grove St, Los Angeles",money:"999",zip:"CA 90036"},{date:"2016-05-04",name:"Tom",state:"California",city:"Los Angeles",address:"No. 189, Grove St, Los Angeles",money:"999",zip:"CA 90036"},{date:"2016-05-01",name:"Tom",state:"California",city:"Los Angeles",address:"No. 189, Grove St, Los Angeles",money:"999",zip:"CA 90036"},{date:"2016-05-08",name:"Tom",state:"California",city:"Los Angeles",address:"No. 189, Grove St, Los Angeles",money:"999",zip:"CA 90036"},{date:"2016-05-06",name:"Tom",state:"California",city:"Los Angeles",address:"No. 189, Grove St, Los Angeles",money:"999",zip:"CA 90036"},{date:"2016-05-07",name:"Tom",state:"California",city:"Los Angeles",address:"No. 189, Grove St, Los Angeles",money:"999",zip:"CA 90036"}],ue=[{label:"参数",width:"200px",headerAlign:"left",props:[{prop:"property"}]},{label:"说明",props:[{prop:"description"}]},{label:"类型",width:"200px",props:[{prop:"type"}]},{label:"可选值",width:"200px",props:[{prop:"optionalVal"}]},{label:"默认值",width:"200px",props:[{prop:"defaultVal"}]}],le=[{id:1,property:"exportData",description:"导出数据参数",type:"Array",optionalVal:"-",defaultVal:"-",children:[{id:3,property:"header",description:"表头数据",type:"Array",optionalVal:"-",defaultVal:"-"},{id:4,property:"prop",description:"字段名称数据",type:"Array",optionalVal:"-",defaultVal:"-"},{id:5,property:"list",description:"表格显示的数据",type:"Array",optionalVal:"-",defaultVal:"-"},{id:6,property:"multiHeader",description:"表格标题，表格上方显示的数据",type:"Array",optionalVal:"-",defaultVal:"-"},{id:7,property:"sheetName",description:"文档下方工作表页签名称",type:"String",optionalVal:"-",defaultVal:"sheet1"},{id:8,property:"merges",description:"需要合并的单元格数据，该属性与“multiHeader”配合使用，一个标题对应一个合并项数据",type:"Array",optionalVal:"-",defaultVal:"当只有一个标题时，默认合并第一行所有列"},{id:9,property:"border",description:"是否需要给每个单元格显示黑色边框，设置后优先级最高",type:"Boolean",optionalVal:"true，false",defaultVal:"-"},{id:10,property:"autoWidth",description:"是否需要自适应文档每列宽度，设置后优先级最高",type:"Boolean",optionalVal:"true，false",defaultVal:"-"},{id:11,property:"align",description:"单元格对齐方式，设置后优先级最高",type:"String",optionalVal:"center，left，right",defaultVal:"-"},{id:12,property:"stripe",description:"是否需要斑马纹，设置后优先级最高",type:"Boolean",optionalVal:"true，false",defaultVal:"-"},{id:13,property:"showSummary",description:"是否在最后一行开启合计功能",type:"Boolean",optionalVal:"true，false",defaultVal:"false"},{id:14,property:"summaryList",description:"合计数据",type:"Array",optionalVal:"-",defaultVal:"-"}]},{id:2,property:"configData",description:"导出配置参数",type:"Object",optionalVal:"-",defaultVal:"-",children:[{id:8,property:"fileName",description:"文档名称",type:"string | number",optionalVal:"-",defaultVal:"导出(XX条数据)"},{id:15,property:"border",description:"是否需要给每个单元格显示黑色边框，优先级低于exportData中的border",type:"Boolean",optionalVal:"true，false",defaultVal:"true"},{id:16,property:"autoWidth",description:"是否需要自适应文档每列宽度，优先级低于exportData中的autoWidth",type:"Boolean",optionalVal:"true，false",defaultVal:"true"},{id:17,property:"align",description:"单元格对齐方式，优先级低于exportData中的align",type:"String",optionalVal:"center，left，right",defaultVal:"center"},{id:18,property:"stripe",description:"是否需要斑马纹，优先级低于exportData中的stripe",type:"Boolean",optionalVal:"true，false",defaultVal:"false"}]}];function x(l=[{header:[],prop:[],list:[]}],e={}){q(()=>import("./exportToExcel-9592d0e0.js"),["assets/exportToExcel-9592d0e0.js","assets/index-eb619e6a.js","assets/index-9ee416b9.css"]).then(B=>{const E=[],A=[],C=[],r=[],s=[],n=[],f=[],d=[],F=[],b="导出("+l[0].list.length+"条数据)",y=e.fileName||b;e.fileName=y,l.forEach((i,p)=>{E.push(i.header||[]),A.push(V(i)),C.push(i.multiHeader||[]),s.push(i.merges||[]),r.push(i.sheetName||""),n.push(i.border||void 0),f.push(i.autoWidth||void 0),d.push(i.align||""),F.push(i.stripe||void 0)}),B.export_json_to_excel_sheet({headers:E,datas:A,multiHeaders:C,sheetNames:r,merges:s,borders:n,autoWidths:f,aligns:d,stripes:F},e);function V(i){const p=[];if(p.push(..._(i.prop,i.list)),i.showSummary){const g=[];g.push(...i.summaryList||[]),p.push(g)}return p}function _(i,p){return p.map(g=>i.map(a=>g[a]))}})}const te=T({name:"",setup(){const l=L({tableData2:ee,formInline2:{align:"center",border:!0,autoWidth:!0,stripe:!1,showSummary:!0,showUnit:!0,sumToFixed:2,sumText:"Total Cost",emptyText:"-"},sums:[""]});v(()=>{});const e=()=>{const E=[{prop:["date","name","state","city","address","money","zip"],list:l.tableData2,multiHeader:["Date","Delivery Info","Name","Address Info","State","City","Address","Money(RMB)","Zip"],merges:["A1:A3","B1:F1","B2:B3","C2:F2","C3:C3","D3:D3","E3:E3","F3:F3","G3:G3","A4:A6"],showSummary:l.formInline2.showSummary,summaryList:l.sums}];x(E,{border:l.formInline2.border,autoWidth:l.formInline2.autoWidth,align:l.formInline2.align,stripe:l.formInline2.stripe})},B=E=>{const{columns:A,data:C}=E,r=[];return A.forEach((s,n)=>{if(n===0){r[n]=l.formInline2.sumText;return}var f=l.formInline2.showUnit?s.label.substring(s.label.indexOf("(")+1,s.label.indexOf(")")):"";const d=C.map(F=>Number(F[s.property]));d.every(F=>isNaN(F))?r[n]=l.formInline2.emptyText:(r[n]=d.reduce((F,b)=>{const y=Number(b);return isNaN(y)?F:F+b},0),r[n]=Number(r[n]).toFixed(l.formInline2.sumToFixed||2)+" "+f)}),l.sums=r,r};return{...z(l),export2:e,getSummaries:B}}});function oe(l,e,B,E,A,C){const r=h,s=U,n=X,f=M,d=O,F=Z,b=$,y=H,V=k,_=P,i=Q,p=R,g=j;return I(),D(N,null,[e[28]||(e[28]=m("div",{class:"tipBox"},[o(" 复杂表格导出 "),m("div",{style:{"font-size":"13px",color:"var(--el-color-info)"}}," （多级表头，合计） ")],-1)),u(_,{inline:!0,model:l.formInline2},{default:t(()=>[u(n,{label:"对其方式："},{default:t(()=>[u(s,{modelValue:l.formInline2.align,"onUpdate:modelValue":e[0]||(e[0]=a=>l.formInline2.align=a),placeholder:"对其方式",style:{width:"100px"}},{default:t(()=>[u(r,{label:"靠左",value:"left"}),u(r,{label:"居中",value:"center"}),u(r,{label:"靠右",value:"right"})]),_:1},8,["modelValue"])]),_:1}),u(n,{label:"边框："},{default:t(()=>[u(d,{modelValue:l.formInline2.border,"onUpdate:modelValue":e[1]||(e[1]=a=>l.formInline2.border=a)},{default:t(()=>[u(f,{label:!0},{default:t(()=>e[9]||(e[9]=[o("是")])),_:1,__:[9]}),u(f,{label:!1},{default:t(()=>e[10]||(e[10]=[o("否")])),_:1,__:[10]})]),_:1},8,["modelValue"])]),_:1}),u(n,{label:"自适应宽度："},{default:t(()=>[u(d,{modelValue:l.formInline2.autoWidth,"onUpdate:modelValue":e[2]||(e[2]=a=>l.formInline2.autoWidth=a)},{default:t(()=>[u(f,{label:!0},{default:t(()=>e[11]||(e[11]=[o("是")])),_:1,__:[11]}),u(f,{label:!1},{default:t(()=>e[12]||(e[12]=[o("否")])),_:1,__:[12]})]),_:1},8,["modelValue"])]),_:1}),u(n,{label:"带斑马纹："},{default:t(()=>[u(d,{modelValue:l.formInline2.stripe,"onUpdate:modelValue":e[3]||(e[3]=a=>l.formInline2.stripe=a)},{default:t(()=>[u(f,{label:!0},{default:t(()=>e[13]||(e[13]=[o("是")])),_:1,__:[13]}),u(f,{label:!1},{default:t(()=>e[14]||(e[14]=[o("否")])),_:1,__:[14]})]),_:1},8,["modelValue"])]),_:1}),u(n,{label:"是否合计："},{default:t(()=>[u(d,{modelValue:l.formInline2.showSummary,"onUpdate:modelValue":e[4]||(e[4]=a=>l.formInline2.showSummary=a)},{default:t(()=>[u(f,{label:!0},{default:t(()=>e[15]||(e[15]=[o("是")])),_:1,__:[15]}),u(f,{label:!1},{default:t(()=>e[16]||(e[16]=[o("否")])),_:1,__:[16]})]),_:1},8,["modelValue"])]),_:1}),l.formInline2.showSummary?(I(),D(N,{key:0},[u(n,null,{label:t(()=>[e[18]||(e[18]=o(" 是否需要单位 ")),u(F,{placement:"top",title:"提示说明",width:200,trigger:"hover",content:"是否在合计数字后面显示单位，该单位来源于表头label设置在英文小括号”()“中的文本内容"},{reference:t(()=>e[17]||(e[17]=[m("i",{class:"el-icon-question"},null,-1)])),_:1}),e[19]||(e[19]=o(" ： "))]),default:t(()=>[u(d,{modelValue:l.formInline2.showUnit,"onUpdate:modelValue":e[5]||(e[5]=a=>l.formInline2.showUnit=a)},{default:t(()=>[u(f,{label:!0},{default:t(()=>e[20]||(e[20]=[o("是")])),_:1,__:[20]}),u(f,{label:!1},{default:t(()=>e[21]||(e[21]=[o("否")])),_:1,__:[21]})]),_:1},8,["modelValue"])]),_:1}),u(n,{label:"保留小数位："},{default:t(()=>[u(b,{style:{width:"100px"},modelValue:l.formInline2.sumToFixed,"onUpdate:modelValue":e[6]||(e[6]=a=>l.formInline2.sumToFixed=a),placeholder:"请输入"},{append:t(()=>e[22]||(e[22]=[o("位")])),_:1},8,["modelValue"])]),_:1}),u(n,{label:"第一列文本内容："},{default:t(()=>[u(b,{style:{width:"100px"},modelValue:l.formInline2.sumText,"onUpdate:modelValue":e[7]||(e[7]=a=>l.formInline2.sumText=a),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),u(n,{label:"无数据文本内容："},{default:t(()=>[u(b,{style:{width:"100px"},modelValue:l.formInline2.emptyText,"onUpdate:modelValue":e[8]||(e[8]=a=>l.formInline2.emptyText=a),placeholder:"请输入"},null,8,["modelValue"])]),_:1})],64)):J("",!0),u(n,null,{default:t(()=>[u(V,null,{default:t(()=>[u(y,{type:"primary",icon:"Files",onClick:l.export2},{default:t(()=>e[23]||(e[23]=[o("导出")])),_:1,__:[23]},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["model"]),e[29]||(e[29]=m("h4",null,"多级表头参数说明：",-1)),e[30]||(e[30]=o(" 此处涉及到exportData导出数据的两个参数： ")),m("ul",null,[m("li",null,[u(i,null,{default:t(()=>e[24]||(e[24]=[o("multiHeader")])),_:1,__:[24]}),e[25]||(e[25]=o("{Array}：表头名称数据。"))]),m("li",null,[u(i,null,{default:t(()=>e[26]||(e[26]=[o("merges：")])),_:1,__:[26]}),e[27]||(e[27]=o("{Array}：合并项规则，需要合并的单元格数据，该属性与“multiHeader”配合使用，一个标题对应一个合并项。例如：['A1:A3', 'B1:F1', 'B2:B3', 'C2:F2', 'C3:C3', 'D3:D3', 'E3:E3','F3:F3', 'G3:G3']，其中每个元素中的A，B，C，D...代表表格的纵坐标， 1，2，3，4...代表表格的横坐标，一个纵坐标(字母)和一个横坐标(数字)结合确定一个单元格，参考Excel文档。 "))])]),e[31]||(e[31]=o(" 以下表为例： ")),e[32]||(e[32]=m("ul",null,[m("li",null," Data表头属于行合并，是从A1单元格合并到A3单元格，因此合并项数据为A1:A3； "),m("li",null," Delivery Info是列合并，从B1单元格合并到F1单元格，因此合并项数据为B1:F1； "),m("li",null,"如果没有合并项的单元格例如State合并项数据首尾相同为C3:C3；")],-1)),e[33]||(e[33]=m("p",null,null,-1)),u(g,{ref:"multipleTable",data:l.tableData2,border:l.formInline2.border,stripe:l.formInline2.stripe,"summary-method":l.getSummaries,"show-summary":l.formInline2.showSummary,style:{width:"100%"}},{default:t(()=>[u(p,{prop:"date",align:l.formInline2.align,label:"Date",width:"150"},null,8,["align"]),u(p,{label:"Delivery Info"},{default:t(()=>[u(p,{prop:"name",align:l.formInline2.align,label:"Name",width:"120"},null,8,["align"]),u(p,{label:"Address Info"},{default:t(()=>[u(p,{prop:"state",align:l.formInline2.align,label:"State",width:"120"},null,8,["align"]),u(p,{prop:"city",align:l.formInline2.align,label:"City",width:"120"},null,8,["align"]),u(p,{prop:"address",align:l.formInline2.align,label:"Address"},null,8,["align"]),u(p,{prop:"money",align:l.formInline2.align,label:"Money(RMB)",width:"120"},null,8,["align"]),u(p,{prop:"zip",align:l.formInline2.align,label:"Zip",width:"120"},null,8,["align"])]),_:1})]),_:1})]),_:1},8,["data","border","stripe","summary-method","show-summary"])],64)}const ae=G(te,[["render",oe]]),ne=T({components:{multipleHeadersExport:ae},setup(){const l=w(),e=L({tableData1:c,formInline1:{subtitle:"XXX系统",align:"center",border:!0,autoWidth:!0,stripe:!1}});let B=w(le),E=w(ue);const A=()=>{const r=[{header:["Date","Name","Address"],prop:["date","name","address"],list:e.tableData1,multiHeader:[e.formInline1.subtitle]}];x(r,{border:e.formInline1.border,autoWidth:e.formInline1.autoWidth,align:e.formInline1.align,stripe:e.formInline1.stripe})},C=()=>{const r=[{header:["Date","Name","Address"],prop:["date","name","address"],list:e.tableData1,multiHeader:[e.formInline1.subtitle],border:e.formInline1.border,autoWidth:e.formInline1.autoWidth,align:e.formInline1.align,stripe:e.formInline1.stripe},{header:["Date","Name","Address"],list:e.tableData1,multiHeader:[e.formInline1.subtitle],border:e.formInline1.border,autoWidth:e.formInline1.autoWidth,align:e.formInline1.align,stripe:e.formInline1.stripe}];x(r,{fileName:"多表导出"})};return v(()=>{}),{list:B,config:E,multipleTable:l,onMounted:v,export1:A,export3:C,...z(e)}}});function re(l,e,B,E,A,C){const r=$,s=X,n=h,f=U,d=M,F=O,b=H,y=k,V=P,_=R,i=j,p=S("multipleHeadersExport"),g=S("powerful-table");return I(),D(N,null,[e[18]||(e[18]=W('<div class="tipBox warning" data-v-4fab69d1><span data-v-4fab69d1> 使用 <a style="color:#409eff;" target="_blank" href="https://github.com/exceljs/exceljs/blob/master/README_zh.md" data-v-4fab69d1>xlsx</a> 实现导入数据<span style="font-size:13px;color:var(--el-color-info);" data-v-4fab69d1>（注：该示例仅供参考，具体逻辑请自行实现）</span></span></div><div class="tipBox" data-v-4fab69d1> 基础表格导出 <div style="font-size:13px;color:var(--el-color-info);" data-v-4fab69d1></div></div>',2)),m("div",null,[u(V,{inline:!0,model:l.formInline1,size:"small"},{default:t(()=>[u(s,{label:"副标题："},{default:t(()=>[u(r,{modelValue:l.formInline1.subtitle,"onUpdate:modelValue":e[0]||(e[0]=a=>l.formInline1.subtitle=a),placeholder:"副标题"},null,8,["modelValue"])]),_:1}),u(s,{label:"对其方式："},{default:t(()=>[u(f,{modelValue:l.formInline1.align,"onUpdate:modelValue":e[1]||(e[1]=a=>l.formInline1.align=a),placeholder:"对其方式",style:{width:"100px"}},{default:t(()=>[u(n,{label:"靠左",value:"left"}),u(n,{label:"居中",value:"center"}),u(n,{label:"靠右",value:"right"})]),_:1},8,["modelValue"])]),_:1}),u(s,{label:"边框："},{default:t(()=>[u(F,{modelValue:l.formInline1.border,"onUpdate:modelValue":e[2]||(e[2]=a=>l.formInline1.border=a)},{default:t(()=>[u(d,{label:!0},{default:t(()=>e[5]||(e[5]=[o("是")])),_:1,__:[5]}),u(d,{label:!1},{default:t(()=>e[6]||(e[6]=[o("否")])),_:1,__:[6]})]),_:1},8,["modelValue"])]),_:1}),u(s,{label:"自适应宽度："},{default:t(()=>[u(F,{modelValue:l.formInline1.autoWidth,"onUpdate:modelValue":e[3]||(e[3]=a=>l.formInline1.autoWidth=a)},{default:t(()=>[u(d,{label:!0},{default:t(()=>e[7]||(e[7]=[o("是")])),_:1,__:[7]}),u(d,{label:!1},{default:t(()=>e[8]||(e[8]=[o("否")])),_:1,__:[8]})]),_:1},8,["modelValue"])]),_:1}),u(s,{label:"带斑马纹："},{default:t(()=>[u(F,{modelValue:l.formInline1.stripe,"onUpdate:modelValue":e[4]||(e[4]=a=>l.formInline1.stripe=a)},{default:t(()=>[u(d,{label:!0},{default:t(()=>e[9]||(e[9]=[o("是")])),_:1,__:[9]}),u(d,{label:!1},{default:t(()=>e[10]||(e[10]=[o("否")])),_:1,__:[10]})]),_:1},8,["modelValue"])]),_:1}),u(s,null,{default:t(()=>[u(y,null,{default:t(()=>[u(b,{type:"primary",icon:"files",size:"small",onClick:l.export1},{default:t(()=>e[11]||(e[11]=[o("导出")])),_:1,__:[11]},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["model"]),e[13]||(e[13]=m("p",null,null,-1)),u(i,{data:l.tableData1,height:"200",border:l.formInline1.border,stripe:l.formInline1.stripe,style:{width:"100%"}},{default:t(()=>[u(_,{prop:"date",align:l.formInline1.align,label:"Date",width:"180"},null,8,["align"]),u(_,{prop:"name",align:l.formInline1.align,label:"Name",width:"180"},null,8,["align"]),u(_,{prop:"address",align:l.formInline1.align,label:"Address"},null,8,["align"])]),_:1},8,["data","border","stripe"]),e[14]||(e[14]=m("p",null,null,-1)),u(p),e[15]||(e[15]=m("p",null,null,-1)),e[16]||(e[16]=m("div",{class:"tipBox"},[o(" 多表格导出 "),m("div",{style:{"font-size":"13px",color:"var(--el-color-info)"}}," （一次导出上面两个表格，通过xlsx文档下面sheet页签切换） ")],-1)),u(y,null,{default:t(()=>[u(b,{type:"primary",icon:"files",size:"small",onClick:l.export3},{default:t(()=>e[12]||(e[12]=[o("多表导出")])),_:1,__:[12]},8,["onClick"])]),_:1}),e[17]||(e[17]=W('<p data-v-4fab69d1></p><div class="tipBox warning" data-v-4fab69d1><span data-v-4fab69d1> 参数文档<span style="font-size:13px;color:var(--el-color-info);" data-v-4fab69d1>（为了更方便使用，我们为此封装了一个公共方法用于导出，通过传入参数数据的形式控制导出内容，目前仅支持基础导出功能，也就是上面两个导出表格例子展示的内容，其他业务逻辑可以参考 <a style="color:#409eff;" target="_blank" href="https://github.com/exceljs/exceljs/blob/master/README_zh.md" data-v-4fab69d1>xlsx</a> 官方文档自行实现）</span></span></div><div class="tipBox" data-v-4fab69d1> 公共方法及参数 <div style="font-size:13px;color:var(--el-color-info);" data-v-4fab69d1> （exportExcelSheet(exportData,configData)） </div></div>',3)),u(g,{list:l.list,header:l.config,isPagination:!1},null,8,["list","header"])])],64)}const ie=G(ne,[["render",re],["__scopeId","data-v-4fab69d1"]]),se=T({name:"Export",components:{customizeExport:ie},setup(){const l=L({});return v(()=>{}),{onMounted:v,...z(l)}}});const de={class:"app-container"};function pe(l,e,B,E,A,C){const r=K,s=S("customizeExport"),n=Y;return I(),D("div",de,[u(n,{shadow:l.defaultData.cardShadow},{default:t(()=>[u(r),u(s)]),_:1},8,["shadow"])])}const be=G(se,[["render",pe],["__scopeId","data-v-504be6b7"]]);export{be as default};
